"use strict";(self.webpackChunkcnl=self.webpackChunkcnl||[]).push([[503],{9503:(P,m,s)=>{s.r(m),s.d(m,{PaymentTransactionComponent:()=>_});var e=s(5879),r=s(6814),d=s(3929),p=s(7871),f=s(2787);let u=(()=>{class a{refreshTable(){this.taTableComponent?.refresh()}constructor(t){this.router=t,this.edit=new e.vpe,this.tableConfig={apiUrl:"finance/payment_transactions/",showCheckbox:!0,pkId:"payment_id",pageSize:10,globalSearch:{keys:["payment_date","invoice_id","order_type","payment_method","payment_status","amount","reference_number","currency","transaction_type","notes"]},defaultSort:{key:"created_at",value:"descend"},cols:[{fieldKey:"invoice_id",name:"Invoice",sort:!0},{fieldKey:"order_type",name:"Order Type",sort:!0},{fieldKey:"payment_date",name:"Payment Date",sort:!0},{fieldKey:"payment_method",name:"Payment Method",sort:!0},{fieldKey:"payment_status",name:"Payment Status",sort:!0},{fieldKey:"amount",name:"Amount",sort:!0},{fieldKey:"reference_number",name:"Reference Number",sort:!0},{fieldKey:"currency",name:"Currency",sort:!0},{fieldKey:"transaction_type",name:"Transaction Type",sort:!0},{fieldKey:"notes",name:"Notes",sort:!0},{fieldKey:"code",name:"Action",type:"action",actions:[{type:"delete",label:"Delete",apiUrl:"finance/payment_transactions",confirm:!0,confirmMsg:"Sure to delete?"},{type:"callBackFn",icon:"fa fa-pen",label:"",callBackFn:(n,o)=>{console.log(n),this.edit.emit(n.payment_id)}}]}]}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(f.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-payment-transaction-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(p.Z,5),2&t){let o;e.iGM(o=e.CRH())&&(n.taTableComponent=o.first)}},outputs:{edit:"edit"},standalone:!0,features:[e.jDz],decls:1,vars:1,consts:[[3,"options"]],template:function(t,n){1&t&&e._UZ(0,"ta-table",0),2&t&&e.Q6J("options",n.tableConfig)},dependencies:[r.ez,d.l,p.Z]}),a})();var h=s(9862),b=s(7127);function v(a,i){1&a&&(e.TgZ(0,"span",17),e._uU(1,"Update Transaction"),e.qZA())}function C(a,i){1&a&&(e.TgZ(0,"span",17),e._uU(1,"Create Transaction"),e.qZA())}function T(a,i){if(1&a&&(e.TgZ(0,"div",18),e._UZ(1,"ta-form",19),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("options",t.formConfig)}}function g(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",20)(1,"app-payment-transaction-list",21),e.NdJ("edit",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.editPaymentTransaction(o))}),e.qZA()()}}let _=(()=>{class a{constructor(t,n){this.http=t,this.cd=n,this.showPaymentTransactionList=!1,this.showForm=!1,this.invoiceOptions=[],this.formConfig={}}loadInvoices(t){let n="";if("Sale"===t)n="sales/sale_invoice_order_get/";else{if("Purchase"!==t)return void console.error("Invalid order_type provided");n="purchase/purchase_invoice_orders_get/"}this.http.get(n).subscribe(o=>{const c=o.data,y=this.formConfig.fields[0].fieldGroup.find(l=>"invoice"===l.key);y&&(this.invoiceOptions=c.map(l=>({value:{invoice_id:l.invoice_no,invoice_no:l.invoice_no},label:l.invoice_no})),y.templateOptions.options=this.invoiceOptions,this.cd.detectChanges())},o=>{console.log("Error fetching invoices:",o)})}ngOnInit(){this.showPaymentTransactionList=!1,this.showForm=!0,this.PaymentTransactionEditID=null,this.setFormConfig()}hide(){document.getElementById("modalClose").click()}editPaymentTransaction(t){this.PaymentTransactionEditID=t,this.http.get("finance/payment_transactions/"+t).subscribe(n=>{n&&(this.formConfig.model=n,this.formConfig.showActionBtn=!0,this.formConfig.pkId="payment_id",this.formConfig.submit.label="Update",this.showForm=!0)}),this.hide()}showPaymentTransactionListFn(){this.showPaymentTransactionList=!0,this.PaymentTransactionListComponent?.refreshTable()}setFormConfig(){this.PaymentTransactionEditID=null,this.formConfig={url:"finance/payment_transactions/",formState:{viewMode:!1},showActionBtn:!0,exParams:[{key:"invoice",type:"script",value:"data.invoice.invoice_id"}],submit:{label:"Submit",submittedFn:()=>this.ngOnInit()},reset:{resetFn:()=>{this.ngOnInit()}},model:{},fields:[{fieldGroupClassName:"ant-row custom-form-block px-0 mx-0",fieldGroup:[{key:"order_type",type:"select",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Order Type",placeholder:"Select Order Type",required:!0,options:[{value:"Sale",label:"Sale"},{value:"Purchase",label:"Purchase"}]},hooks:{onChanges:t=>{t.formControl.valueChanges.subscribe(n=>{n&&this.loadInvoices(n)})}}},{key:"invoice",type:"select",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Invoice",dataKey:"invoice_id",dataLabel:"invoice_no",options:[],lazy:{lazyOneTime:!0},required:!1},hooks:{onInit:t=>{t.formControl.valueChanges.subscribe(n=>{this.formConfig&&this.formConfig.model&&this.formConfig.model.invoice?this.formConfig.model.invoice_id=n.invoice_id:console.error("Form config or invoice_id data model is not defined.")})}}},{key:"payment_date",type:"date",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Payment Date",placeholder:"Select Payment Date",required:!0}},{key:"payment_method",type:"select",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Payment Method",placeholder:"Select Payment Method",required:!0,options:[{value:"Cash",label:"Cash"},{value:"Bank Transfer",label:"Bank Transfer"},{value:"Credit Card",label:"Credit Card"},{value:"Cheque",label:"Cheque"}]}},{key:"payment_status",type:"select",className:"col-md-4 col-sm-6 col-12",defaultValue:"Pending",templateOptions:{label:"Payment Status",placeholder:"Select Payment Status",required:!0,options:[{value:"Pending",label:"Pending"},{value:"Completed",label:"Completed"},{value:"Failed",label:"Failed"}]}},{key:"amount",type:"input",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Amount",placeholder:"Enter Amount",required:!0}},{key:"reference_number",type:"input",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Reference Number",placeholder:"Enter Reference Number",required:!1}},{key:"currency",type:"input",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Currency",placeholder:"Enter Currency",required:!1}},{key:"transaction_type",type:"select",className:"col-md-4 col-sm-6 col-12",defaultValue:"Credit",templateOptions:{label:"Transaction Type",placeholder:"Select Transaction Type",required:!0,options:[{value:"Credit",label:"Credit"},{value:"Debit",label:"Debit"}]}},{key:"notes",type:"textarea",className:"col-md-4 col-sm-6 col-12",templateOptions:{label:"Notes",placeholder:"Enter Notes",required:!1}}]}]}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(h.eN),e.Y36(e.sBO))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-payment-transaction"]],viewQuery:function(t,n){if(1&t&&e.Gf(u,5),2&t){let o;e.iGM(o=e.CRH())&&(n.PaymentTransactionListComponent=o.first)}},standalone:!0,features:[e.jDz],decls:21,vars:4,consts:[[1,"container-fluid","p-3"],[1,"bank-account-banner"],[1,"col-12","px-0",2,"display","flex","justify-content","space-between","align-items","center","flex-wrap","wrap"],["type","button",1,"btn","pl-0",2,"color","black",3,"click"],["class","custom-heading",4,"ngIf"],["type","button","data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-primary",3,"click"],[1,"row","custom-form"],["class","col-12 px-1",4,"ngIf"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade","custom-modal"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","id","modalClose","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger"],[1,"custom-heading"],[1,"col-12","px-1"],[3,"options"],[1,"modal-body"],[1,"custom-list",3,"edit"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e.NdJ("click",function(){return n.PaymentTransactionEditID=null}),e.YNc(4,v,2,0,"span",4),e.YNc(5,C,2,0,"span",4),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return n.showPaymentTransactionListFn()}),e._uU(7," Transaction List "),e.qZA()()(),e.TgZ(8,"div",6),e.YNc(9,T,2,1,"div",7),e.qZA()(),e.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"h5",12),e._uU(15,"Edit Payment Transaction List"),e.qZA(),e._UZ(16,"button",13),e.qZA(),e.YNc(17,g,2,0,"div",14),e.TgZ(18,"div",15)(19,"button",16),e._uU(20,"Close"),e.qZA()()()()()),2&t&&(e.xp6(4),e.Q6J("ngIf",n.PaymentTransactionEditID),e.xp6(1),e.Q6J("ngIf",!n.PaymentTransactionEditID),e.xp6(4),e.Q6J("ngIf",n.showForm),e.xp6(8),e.Q6J("ngIf",n.showPaymentTransactionList))},dependencies:[r.ez,r.O5,d.l,b.C,u]}),a})()}}]);