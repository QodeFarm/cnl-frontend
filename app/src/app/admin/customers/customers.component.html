<div class="customers-component container-fluid pt-3">
  <div class="customers-banner">
    <div class="col-12 px-0" style="display: flex; justify-content: space-between;align-items: center;">
      <button (click)="CustomerEditID = null" type="button" class="btn pl-0" style="color: black;">
        <span *ngIf="CustomerEditID" class="custom-heading">Update Customer</span>
        <span *ngIf="!CustomerEditID" class="custom-heading">Create Customer</span>
      </button>
      <!-- Button Group: Import + Customer List -->
      <div class="d-flex gap-2">
        <!-- Import Button with Dropdown -->
        <div class="btn-group">
          <button type="button" class="btn btn-primary" (click)="showImportModal()">Import</button>
          <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false"></button>
          <ul class="dropdown-menu">
            <!-- <li><a class="dropdown-item" href="assets/import-template.xlsx" download>Download Excel Format</a></li> -->
              <a class="dropdown-item" (click)="downloadExcelTemplate()">Download Excel Format</a>
          </ul>
        </div>

        <!-- Customer List Button -->
        <button (click)="showCustomerListFn()" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
          Customer List
        </button>
      </div>
    </div>
  </div>

  <div class="row custom-form">
    <div class="col-12 px-1" *ngIf="showForm">
      <ta-form [options]="formConfig"></ta-form>
    </div>
  </div>
</div>

<div class="modal fade custom-modal" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Edit Customer List</h5>
        <button type="button" id="modalClose" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" *ngIf="showCustomerList">
        <app-customers-list (edit)="editCustomer($event)" class="custom-list"></app-customers-list>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>



<!-- Import Modal -->
<div class="modal fade custom-modal" id="importModal" tabindex="-1" aria-labelledby="importModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="importModalLabel">Import Customers from Excel</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="modalClose"></button>
      </div>
      <div class="modal-body">
        <!-- Add this somewhere in your HTML -->
        <button id="downloadTemplateBtn" (click)="downloadExcelTemplate()" style="display: none;"></button>
        <!-- Update the import modal info section -->
        <div class="alert alert-info mb-3">
          <p class="mb-1"><strong>Instructions:</strong></p>
          <ul class="mb-0">
            <li>Download and use the official <a href="#" (click)="downloadExcelTemplate(); $event.preventDefault()">Excel Template</a></li>
            <li>Required fields: Name, Print Name, Customer Category</li>
            <!-- <li>All column names must match exactly as in the template</li> -->
            <li>Only Excel files (.xlsx, .xls) are supported</li>
          </ul>
        </div>
        <ta-form [options]="importFormConfig"></ta-form>
      </div>
    </div>
  </div>
</div>

<div id="customToast" class="toast-message" *ngIf="showSuccessToast">
  <div class="tick-circle">
      <span class="tick-mark">✓</span>
  </div>
  <span class="toast-message-text">{{ toastMessage }}</span>
  <span class="toast-close" onclick="this.parentElement.style.display='none'">x</span>
</div>

<div id="customDialog" class="custom-dialog-overlay" style="display: none;">
  <div class="custom-dialog-box">
  <p> ⚠️ Please fill in all required fields in <b>Customers</b> or <b>Addresses</b> or <b>Custom fields</b> before submitting.</p>
  <button id="dialogOkButton" (click)="closeDialog()">OK</button>
  </div>
</div>