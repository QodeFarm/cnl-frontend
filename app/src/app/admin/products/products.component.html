<div class="container-fluid p-3">
    <div class="products-banner">
        <div class="col-12 px-0" style="display: flex; justify-content: space-between; align-items: center;flex-wrap: wrap;">
            <button (click)="ProductEditID = null" type="button" class="btn pl-0" style="color: black;">
                <span *ngIf="ProductEditID" class="custom-heading">Update Products</span>
                <span *ngIf="!ProductEditID" class="custom-heading">Create Products</span>
            </button>
            <!-- <button (click)="showProductsListFn()" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#productModal">Products List
            </button> -->
            <!-- Button Group: Import + Products List -->
        <div class="d-flex gap-2">
            <!-- Import Button with Dropdown -->
            <div class="btn-group">
                <button type="button" class="btn btn-primary" (click)="showImportModal()">Import</button>
                <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false"></button>
                <ul class="dropdown-menu">
                    <a class="dropdown-item" (click)="downloadExcelTemplate()">Download Excel Format</a>
                </ul>
            </div>

            <!-- Products List Button -->
            <button (click)="showProductsListFn()" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#productModal">Products List
            </button>
        </div>
        </div>
    </div>

    <div class="row custom-form">
        <div class="col-12 px-1" *ngIf="ProductEditID || showForm">
            <ta-form [options]="formConfig"></ta-form>
        </div>
    </div>
</div>

<div class="modal fade custom-modal" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="productModalLabel">Edit Products List</h5>
                <button type="button" id="modalClose" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" *ngIf="showProductsList">
                <app-products-list (edit)="editProducts($event)" class="custom-list"></app-products-list>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
            </div>
        </div>
    </div>
</div>

<!-- Add this right after your existing product modal -->
<!-- Import Modal -->
<div class="modal fade custom-modal" id="importModal" tabindex="-1" aria-labelledby="importModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="importModalLabel">Import Products from Excel</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" id="modalClose"></button>
      </div>
      <div class="modal-body">
        <!-- Add this somewhere in your HTML -->
        <button id="downloadTemplateBtn" (click)="downloadExcelTemplate()" style="display: none;"></button>
        <!-- Update the import modal info section -->
        <div class="alert alert-info mb-3">
          <p class="mb-1"><strong>Instructions:</strong></p>
          <ul class="mb-0">
            <li>Download and use the official <a href="#" (click)="downloadExcelTemplate(); $event.preventDefault()">Excel Template</a></li>
            <li>Required fields: Name, Print Name, Product Group</li>
            <li>Only Excel files (.xlsx, .xls) are supported</li>
          </ul>
        </div>
        <ta-form [options]="importFormConfig"></ta-form>
      </div>
    </div>
  </div>
</div>

<div id="customDialog" class="custom-dialog-overlay" style="display: none;">
    <div class="custom-dialog-box">
      <p [innerHTML]="dialogMessage"></p>
      <button id="dialogOkButton" (click)="closeDialog()">OK</button>
    </div>
</div>